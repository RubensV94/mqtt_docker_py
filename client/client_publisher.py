#http://www.steves-internet-guide.com/into-mqtt-python-client/


import paho.mqtt.client as mqtt
import time
#(client_id=””, clean_session=True, userdata=None, protocol=MQTTv311, transport=”tcp”)

def on_connect(client, userdata, flags, rc):
    if rc==0:
        print("connected OK Returned code=",rc)
    else:
        print("Bad connection Returned code=",rc)

client =mqtt.Client("amejvel",)
client.username_pw_set(username="fochter",password="123456789")
#connect(host, port=1883, keepalive=60, bind_address=""
#broker_adress='mqtt5-network'  #Este nombre de la red creado desde Docker-compose no lo reconoce, da error
broker_adress="127.0.0.1"
client.on_connect = on_connect
client.connect(broker_adress, port=1883)
#publish(topic, payload=None, qos=0, retain=False)

client.loop_start()
time.sleep(4)
i=100
while i!=0:
    client.publish("house/ligth", "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999")
    time.sleep(0.1)
  
    i-=1
    
client.loop_stop()
